[variables]
PRISMA_SKIP_POSTINSTALL_GENERATE = "true"

[phases.setup]
nixPkgs = [
  "nodejs_20", 
  "openssl", 
  "python311",
  "chromium",
  "chromedriver"
]

[phases.install]
cmds = [
  "npm ci --ignore-scripts",
  "python3 -m venv /app/.venv",
  "/app/.venv/bin/pip install --upgrade pip",
  "/app/.venv/bin/pip install -r scripts/requirements.txt"
]

[phases.build]
cmds = []

[start]
cmd = "npx prisma generate && npx prisma db push --accept-data-loss && node src/index.js"

